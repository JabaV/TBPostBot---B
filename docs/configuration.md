# Конфигурация

## Переменные окружения (.env)

Используется `python-dotenv` для загрузки переменных окружения из файла `.env`. Файл `.env` не коммитится (указан в `.gitignore`).

Параметры:
- TOKEN (str, required)
  - VK API токен для авторизации.
  - Без него приложение завершится с `RuntimeError`.
- DEFAULT_WAIT_TIME (int, seconds, optional)
  - Дефолтный интервал ожидания между проверками/публикациями.
  - По умолчанию 43200 (12 часов).
  - Диапазон: ≥ 0.

Пример `.env`:
```
TOKEN=YOUR_VK_API_TOKEN
DEFAULT_WAIT_TIME=43200
```

## Файлы данных

Каталог `files/`:
- `groups.txt` — конфигурация целей и параметров постинга.
- `tags.txt`, `block1.txt` … `block5.txt`, `links.txt` — варианты блоков для TextBuilder.
- `text1.txt` … `text5.txt` — старые тексты (для совместимости).
- `dumping.pkl` — кэш времени последней публикации по группам.

Расположение файлов — относительное к корню проекта.

## Форматы строк в groups.txt

Поддерживаются два формата: новый и старый.

Новый формат:
```
groupid:[tags:b1:b2:b3:b4:b5:links:image]|delay
```
Где:
- `tags`, `b1..b5`, `links` — идентификаторы вариантов из соответствующих файлов (`##число` или `###имя`) либо `-` для случайного варианта.
- `image` — ID фото (используется как `photo{bot_id}_{image}`).
- `delay` — длительность ожидания, формат `1d2h3m4s` (части опциональны, порядок фиксирован).

Примеры:
```
156716828:[-:1:-:###tajikistan:-:-:-:457239113]|3d2h
51153697:[-:-:-:2:-:-:-:457239111]|12h
```

Старый формат:
```
groupid:path|image[?seconds]
```
- `path == '-'` — выбрать случайный `files/text{1..5}.txt`.
- `?seconds` — опциональная задержка в секундах.

Комментарии:
- Строки, начинающиеся с `# ` (решётка и пробел), игнорируются.

## Формат блочных файлов (TextBuilder)

Файлы:
- `files/tags.txt`
- `files/block1.txt` … `files/block5.txt`
- `files/links.txt`

Разметка вариантов:
- Заголовок варианта на отдельной строке:
  - `##<числовой_id>` или `###<имя>`
- Текст до следующего заголовка — содержимое варианта.

Пример:
```
##1
Текст варианта 1

###intro
Именованный вариант intro
```

## Права и доступ VK

- Токен `TOKEN` должен иметь права на публикацию в заданных сообществах.
- Фото `photo{bot_id}_{image}` должно быть доступно для прикрепления (заранее загружено или доступно боту).
